specVersion: 0.0.4
description: Simplified LoanMachine contract indexing
repository: https://github.com/your-repo/loan-machine-subgraph
schema:
  file: ./scripts/graphql/schema.graphql
dataSources:
  - kind: ethereum/contract
    name: LoanMachine
    network: localhost
    source:
      address: "0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0"
      abi: LoanMachine
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./scripts/graphql/mapping.ts
      entities:
        - DonatedEvent
        - BorrowedEvent
        - RepaidEvent
        - TotalDonationsUpdatedEvent
        - TotalBorrowedUpdatedEvent
        - AvailableBalanceUpdatedEvent
        - NewDonorEvent
        - NewBorrowerEvent
        - BorrowLimitReachedEvent
        - LoanRequisitionCreatedEvent
        - LoanCoveredEvent
        - LoanFundedEvent
        - LoanContractGeneratedEvent
        - ParcelPaidEvent
        - LenderRepaidEvent
        - LoanCompletedEvent
        - WithdrawnEvent
        - BorrowerOverdueEvent
        - BorrowerDebtSettledEvent
        - PeriodicCheckRunEvent
        - LoanRequisitionCancelledEvent
        - LoanUncoveredEvent
      abis:
        - name: LoanMachine
          file: ./scripts/graphql/abis/LoanMachine.json
      eventHandlers:
        - event: Donated(indexed address,uint256,uint256)
          handler: handleDonated
        - event: Borrowed(indexed address,uint256,uint256)
          handler: handleBorrowed
        - event: Repaid(indexed address,uint256,uint256)
          handler: handleRepaid
        - event: TotalDonationsUpdated(uint256)
          handler: handleTotalDonationsUpdated
        - event: TotalBorrowedUpdated(uint256)
          handler: handleTotalBorrowedUpdated
        - event: AvailableBalanceUpdated(uint256)
          handler: handleAvailableBalanceUpdated
        - event: NewDonor(indexed address)
          handler: handleNewDonor
        - event: NewBorrower(indexed address)
          handler: handleNewBorrower
        - event: BorrowLimitReached(indexed address)
          handler: handleBorrowLimitReached
        - event: LoanRequisitionCreated(indexed uint256,indexed address,uint256,uint32)
          handler: handleLoanRequisitionCreated
        - event: LoanCovered(indexed uint256,indexed address,uint256)
          handler: handleLoanCovered
        - event: LoanFunded(indexed uint256)
          handler: handleLoanFunded
        - event: LoanContractGenerated(indexed address,indexed uint256,uint8,uint32,uint256,uint256[],uint256)
          handler: handleLoanContractGenerated
        - event: ParcelPaid(indexed uint256,uint256)
          handler: handleParcelPaid
        - event: LenderRepaid(indexed uint256,indexed address,uint256)
          handler: handleLenderRepaid
        - event: LoanCompleted(indexed uint256)
          handler: handleLoanCompleted
        - event: Withdrawn(indexed address,uint256,uint256)
          handler: handleWithdrawn
        - event: BorrowerOverdue(indexed uint256,indexed address,uint256)
          handler: handleBorrowerOverdue
        - event: BorrowerDebtSettled(indexed uint256,indexed address)
          handler: handleBorrowerDebtSettled
        - event: PeriodicCheckRun(uint256,uint256)
          handler: handlePeriodicCheckRun
        - event: LoanRequisitionCancelled(indexed uint256,indexed address,uint256)
          handler: handleLoanRequisitionCancelled
        - event: LoanUncovered(indexed uint256,indexed address,uint256)
          handler: handleLoanUncovered
  - kind: ethereum/contract
    name: ReputationSystem
    network: localhost
    source:
      address: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
      abi: ReputationSystem
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./scripts/graphql/mapping.ts
      entities:
        - MemberToWalletVinculationEvent
        - ReputationChangedEvent
        - AuthorizedCallerUpdatedEvent
        - ElectionOpenedEvent
        - CandidateAddedEvent
        - VoteCastEvent
        - ElectionClosedEvent
        - UnbeatableMajorityReachedEvent
        - NewModeratorEvent  
      abis:
        - name: ReputationSystem
          file: ./scripts/graphql/abis/ReputationSystem.json
      eventHandlers:
        - event: MemberToWalletVinculation(indexed uint32,indexed address,address[],uint256)
          handler: handleMemberToWalletVinculation
        - event: ReputationChanged(indexed uint32,int32,bool,int32,uint256)
          handler: handleReputationChanged
        - event: AuthorizedCallerUpdated(indexed address,bool)
          handler: handleAuthorizedCallerUpdated
        - event: ElectionOpened(indexed uint32,indexed uint32,uint256,uint256)
          handler: handleElectionOpened
        - event: CandidateAdded(indexed uint32,indexed uint32)
          handler: handleCandidateAdded
        - event: VoteCast(indexed uint32,indexed uint32,indexed uint32,int32)
          handler: handleVoteCast
        - event: ElectionClosed(indexed uint32,indexed uint32,int32)
          handler: handleElectionClosed
        - event: UnbeatableMajorityReached(indexed uint32,indexed uint32,int32)
          handler: handleUnbeatableMajorityReached
        - event: NewModerator(indexed uint32,uint32)
          handler: handleNewModerator